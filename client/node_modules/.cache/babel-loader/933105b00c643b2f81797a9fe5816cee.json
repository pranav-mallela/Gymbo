{"ast":null,"code":"import _defineProperty from\"C:/Users/prana/gymbo/client/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Users/prana/gymbo/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"C:/Users/prana/gymbo/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/prana/gymbo/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/prana/gymbo/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React from\"react\";import{Form,Button,Row,Col}from\"react-bootstrap\";import Equipment from'../components/Equipment';import About from'../components/About';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Machines(){var _React$useState=React.useState({machine:\"\",quantity:0}),_React$useState2=_slicedToArray(_React$useState,2),formData=_React$useState2[0],setFormData=_React$useState2[1];var _React$useState3=React.useState(\"\"),_React$useState4=_slicedToArray(_React$useState3,2),search=_React$useState4[0],setSearch=_React$useState4[1];var _React$useState5=React.useState([]),_React$useState6=_slicedToArray(_React$useState5,2),machineData=_React$useState6[0],setMachineData=_React$useState6[1];var _React$useState7=React.useState(false),_React$useState8=_slicedToArray(_React$useState7,2),refresh=_React$useState8[0],setRefresh=_React$useState8[1];React.useEffect(function(){var fetchMachines=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,json;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch('/api/machines');case 2:response=_context.sent;_context.next=5;return response.json();case 5:json=_context.sent;if(!response.ok)console.log(json.error);else setMachineData(json);case 7:case\"end\":return _context.stop();}}},_callee);}));return function fetchMachines(){return _ref.apply(this,arguments);};}();fetchMachines();},[refresh]);function handleChange(e){var _e$target=e.target,name=_e$target.name,value=_e$target.value;setFormData(function(prevData){return _objectSpread(_objectSpread({},prevData),{},_defineProperty({},name,[value]));});if(name==='machine')setSearch(value);}function handleResultClick(e){setFormData(function(prevData){return _objectSpread(_objectSpread({},prevData),{},{machine:e.target.innerHTML});});}var handleSubmit=function handleSubmit(e){e.preventDefault();var _id,method='POST',presentQuantity=0;for(var i=0;i<machineData.length;i++){if(machineData[i].name===formData.machine){_id=machineData[i]._id;if(machineData[i].quantity+parseInt(formData.quantity[0])>0){method='PATCH';presentQuantity=machineData[i].quantity;}else method='DELETE';}}//async function to perform POST/PATCH/DELETE request\nvar sendToDB=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var machineObj,str,response,json;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:machineObj={name:formData.machine.toString(),quantity:presentQuantity+parseInt(formData.quantity[0])};str=method==='POST'?\"\":_id;_context2.next=4;return fetch('/api/machines/'+str,{method:[method],body:JSON.stringify(machineObj),headers:{'Content-Type':'application/json'}});case 4:response=_context2.sent;_context2.next=7;return response.json();case 7:json=_context2.sent;if(!response.ok)console.log(json.error);else{setFormData({machine:\"\",quantity:0});setRefresh(function(prev){return!prev;});}case 9:case\"end\":return _context2.stop();}}},_callee2);}));return function sendToDB(){return _ref2.apply(this,arguments);};}();sendToDB();};var searchResults=[];for(var i=0;i<machineData.length;i++){if(search!==\"\"&&machineData[i].name.toLowerCase().includes(search.toLowerCase())){searchResults.push(machineData[i]);}}var machineEls=machineData.map(function(machineObj){return/*#__PURE__*/_jsx(Equipment,{_id:machineObj._id,machine:machineObj.name,quantity:machineObj.quantity});});var resultEls=searchResults.map(function(machineObj){return/*#__PURE__*/_jsx(\"div\",{className:\"list-hover list-item\",onClick:handleResultClick,children:machineObj.name});});var aboutMachines=\"It keeps track of the quantity of the different equipment in your gym. Clicking 'Manage' updates the quantity by the quantity entered.\";return/*#__PURE__*/_jsxs(\"div\",{className:\"page-container\",children:[/*#__PURE__*/_jsx(About,{aboutText:aboutMachines}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{xs:12,md:6,children:/*#__PURE__*/_jsxs(Form,{className:\"container\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Manage Equipment\"}),/*#__PURE__*/_jsx(Form.Label,{children:\"Machine\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"Machine\",name:\"machine\",value:formData.machine,onChange:handleChange}),formData.machine!=\"\"&&/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:resultEls}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Form.Label,{children:\"Quantity\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"number\",placeholder:\"Quantity\",name:\"quantity\",value:formData.quantity,onChange:handleChange}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"button-container\",children:/*#__PURE__*/_jsx(Button,{variant:\"primary\",type:\"submit\",children:\"Manage\"})})]})}),/*#__PURE__*/_jsx(Col,{xs:12,md:6,children:/*#__PURE__*/_jsx(\"div\",{className:\"machine-list-container container\",children:machineEls})})]})]});}","map":{"version":3,"names":["React","Form","Button","Row","Col","Equipment","About","Machines","useState","machine","quantity","formData","setFormData","search","setSearch","machineData","setMachineData","refresh","setRefresh","useEffect","fetchMachines","fetch","response","json","ok","console","log","error","handleChange","e","target","name","value","prevData","handleResultClick","innerHTML","handleSubmit","preventDefault","_id","method","presentQuantity","i","length","parseInt","sendToDB","machineObj","toString","str","body","JSON","stringify","headers","prev","searchResults","toLowerCase","includes","push","machineEls","map","resultEls","aboutMachines"],"sources":["C:/Users/prana/gymbo/client/src/pages/Machines.js"],"sourcesContent":["import React from \"react\";\r\nimport { Form, Button, Row, Col } from \"react-bootstrap\";\r\nimport Equipment from '../components/Equipment';\r\nimport About from '../components/About';\r\n\r\nexport default function Machines()\r\n{\r\n    const [formData, setFormData] = React.useState({machine: \"\", quantity: 0});\r\n    const [search, setSearch] = React.useState(\"\");\r\n    const [machineData, setMachineData] = React.useState([]);\r\n    const [refresh, setRefresh] = React.useState(false);\r\n\r\n    React.useEffect(() => {\r\n        const fetchMachines = async () => {\r\n            const response = await fetch('/api/machines');\r\n            const json = await response.json();\r\n            if(!response.ok) console.log(json.error);\r\n            else setMachineData(json);\r\n        }\r\n        fetchMachines();\r\n    },[refresh])\r\n\r\n    function handleChange(e)\r\n    {\r\n        const {name, value} = e.target;\r\n        setFormData(prevData => ({...prevData, [name] : [value]}));\r\n        if(name === 'machine') setSearch(value);\r\n    }\r\n\r\n    function handleResultClick(e)\r\n    {\r\n        setFormData(prevData => ({...prevData, machine:e.target.innerHTML}))\r\n    }\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault();\r\n        let _id, method = 'POST', presentQuantity = 0;\r\n        for(let i=0;i<machineData.length;i++)\r\n        {\r\n            if(machineData[i].name === formData.machine)\r\n            {\r\n                _id = machineData[i]._id;\r\n                if(machineData[i].quantity + parseInt(formData.quantity[0]) > 0)\r\n                {\r\n                    method = 'PATCH';\r\n                    presentQuantity = machineData[i].quantity;\r\n                }\r\n                else method = 'DELETE';\r\n            }\r\n        }\r\n        //async function to perform POST/PATCH/DELETE request\r\n        const sendToDB = async () => {\r\n            const machineObj = {\r\n                name: formData.machine.toString(),\r\n                quantity: presentQuantity + parseInt(formData.quantity[0])\r\n            }\r\n            const str = (method === 'POST') ? \"\" : _id;\r\n            const response = await fetch('/api/machines/'+str, {\r\n                method: [method],\r\n                body: JSON.stringify(machineObj),\r\n                headers: {\r\n                    'Content-Type': 'application/json'\r\n                }\r\n            })\r\n            const json = await response.json();\r\n            if(!response.ok) console.log(json.error);\r\n            else{\r\n                setFormData({machine: \"\", quantity: 0});\r\n                setRefresh(prev => !prev);\r\n            }\r\n        }\r\n        sendToDB();\r\n    }\r\n\r\n    const searchResults = [];\r\n    for(let i=0;i<machineData.length;i++)\r\n    {\r\n        if(search !== \"\" && machineData[i].name.toLowerCase().includes(search.toLowerCase()))\r\n        {\r\n            searchResults.push(machineData[i]);\r\n        }\r\n    }\r\n\r\n    const machineEls = machineData.map(machineObj => {\r\n        return <Equipment\r\n                    _id={machineObj._id}\r\n                    machine={machineObj.name}\r\n                    quantity={machineObj.quantity}\r\n                />\r\n    })\r\n\r\n    const resultEls = searchResults.map(machineObj => {\r\n        return <div \r\n                    className=\"list-hover list-item\"\r\n                    onClick={handleResultClick}\r\n                >{machineObj.name}</div>\r\n    })\r\n    const aboutMachines = \"It keeps track of the quantity of the different equipment in your gym. Clicking 'Manage' updates the quantity by the quantity entered.\"\r\n\r\n    return(\r\n        <div className=\"page-container\">\r\n            <About\r\n                aboutText={aboutMachines}\r\n            />\r\n            <Row>\r\n                <Col xs={12} md={6}>\r\n                    <Form className=\"container\" onSubmit={handleSubmit}>\r\n                        <h2>Manage Equipment</h2>\r\n                        <Form.Label>Machine</Form.Label>\r\n                        <Form.Control type=\"text\" placeholder=\"Machine\" name=\"machine\" value={formData.machine} onChange={handleChange} />\r\n                        {formData.machine != \"\" && <div className=\"container\">\r\n                            {resultEls}\r\n                        </div>}\r\n                        <br />\r\n                        <Form.Label>Quantity</Form.Label>\r\n                        <Form.Control type=\"number\" placeholder=\"Quantity\" name=\"quantity\" value={formData.quantity} onChange={handleChange} />\r\n                        <br />\r\n                        <div className='button-container'>\r\n                            <Button variant=\"primary\" type=\"submit\">\r\n                                Manage\r\n                            </Button>\r\n                        </div>\r\n                    </Form>\r\n                </Col>\r\n                <Col xs={12} md={6}>\r\n                    <div className=\"machine-list-container container\">\r\n                        {machineEls}\r\n                    </div>\r\n                </Col>\r\n            </Row>\r\n        </div>\r\n    )\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}